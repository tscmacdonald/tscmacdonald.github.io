<!DOCTYPE html>
<html lang="en">

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Thomas MacDonald


  | Don't be scared of diffusion NMR!

</title>
<meta name="description" content="Thomas MacDonald's personal website. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="https://tscmacdonald.github.io/blog/2021/diffusiontips/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://tscmacdonald.github.io/">
       Thomas MacDonald
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              Blog
              
            </a>
          </li>
          
		  
		  
		  
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/presentations/">
                Presentations
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
		  <!--
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
		  -->
		  
		  <!-- CV -->
		  <li class="nav-item">
            <a class="nav-link" href="https://tscmacdonald.github.io/assets/documents/macdonald_CV.pdf">
              CV
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      





<div class="post">

  <header class="post-header">
    <h1 class="post-title">Don't be scared of diffusion NMR!</h1>
    <p class="post-meta">December 19, 2021</p>
    <p class="post-tags">
      <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>
      
        ·  
        
        <a href="/blog/tag/NMR,">
          <i class="fas fa-hashtag fa-sm"></i> NMR,</a>  
          
        <a href="/blog/tag/diffusion,">
          <i class="fas fa-hashtag fa-sm"></i> diffusion,</a>  
          
        <a href="/blog/tag/chemistry">
          <i class="fas fa-hashtag fa-sm"></i> chemistry</a>  
          
      

      
        ·  
        
        <a href="/blog/category/work">
          <i class="fas fa-tag fa-sm"></i> work</a>  
          
      

    </p>
  </header>

  <article class="post-content">
    <p>A friend messaged me the other day for some advice on how to run diffusion NMR measurements - or perhaps more accurately, on how <em>not</em> to run them. Here are some thoughts on the matter and on potential problems to be aware of when running diffusion NMR measurements. I assume basic familiarity with NMR and diffusion, and don’t meant to be at all comprehesive. If you’re starting to think about diffusion NMR but have no experience with it, I’d recommend starting with Bruker’s Diffusion NMR manual (a practical how-to guide) and then taking a look at Bill Price’s two articles on the fundamentals of pulsed gradient diffusion measurements: <a href="https://doi.org/10.1002/(SICI)1099-0534(1997)9:5%3C299::AID-CMR2%3E3.0.CO;2-U" target="_blank" rel="noopener noreferrer">Part 1: Basic Theory</a> and <a href="https://doi.org/10.1002/(SICI)1099-0534(1998)10:4%3C197::AID-CMR1%3E3.0.CO;2-S" target="_blank" rel="noopener noreferrer">Part 2: Experimental Aspects</a>.</p>

<p>Finally, I’ve written this post assuming that the goal is to obtain an accurate, quantitative measure of diffusion under known conditions. This is not always necessary, and it’s probably OK to be less careful when using diffusion measurements for more qualitative tasks (e.g. resolving the components of a crude mixture by DOSY NMR).</p>

<h1 id="diffusion-basic-physics">Diffusion: basic physics</h1>

<p>What governs diffusion rates? The Stokes-Einstein-<a href="https://doi.org/10.1080/14786440509463331" target="_blank" rel="noopener noreferrer">Sutherland</a> equation for the diffusion of a hard spherical particle at low Reynolds number tells us:</p>

\[D = \frac{k_B T}{6\pi\eta R_H}\]

<p>where \(k_B\) is Boltzmann’s constant, \(T\) is the (absolute) temperature, \(\eta\) is the dynamic viscosity, and \(R_H\) is the hydrodynamic radius of the diffusing particle - the radius of a hard-edged sphere that would diffuse at the same rate. Real molecules are generally neither spherical nor hard-edged, so be careful when relating \(R_H\) to actual dimensions. I think of the hydrodynamic radius as an effective measure of the average size of a molecule incorporating any supramolecular ordering that may form: \(R_H\) of a single chemical species might vary in different solvents as a result of supramolecular (self-)association through solvent coordination, H bonding, ion pairing, cation-\(\pi\) interactions, and so on. As an example, Li+ ions coordinated in THF might appear “bigger” than Li+ in non-coordinating hexane. \(R_H\) can also vary based on the population distributions of different conformers or tautomers that may be favoured in different solvent environments.</p>

<p>It might be tempting to argue that \(\eta\) is fixed for a given solvent and that temperature changes will be relatively small for a system at 298 K +/- a degree or so, and that diffusion is thus only really sensitive to \(R_H\) changing. <em>This is not the case</em>: for most solvents the viscosity \(\eta\) <em>also</em> varies strongly as a function of temperature, making the overall diffusion measurement much more sensitive to changes in temperature. Empirical measurements have found that the dependence of diffusion on temperature is often closer to an exponential Arrhenian relationship:</p>

\[D(T) = A\exp{(-\frac{E_a}{k_B T})}\]

<p>It’s not at all clear to me if \(A\) and \(E_a\) are physically meaningful quantities. This Arrhenian relationship also tends to break down for more “structured” solvents with stronger intermolecular interactions, such as water and small alcohols. Here are some <a href="https://doi.org/10.1039/B005319H" target="_blank" rel="noopener noreferrer">reported values</a> of the “activation energy” for diffusion of common molecular solvents:</p>

<table>
  <thead>
    <tr>
      <th>Solvent</th>
      <th>\(E_a~\mathrm{/~kJ~mol^{-1}}\)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cyclohexane</td>
      <td>13.7</td>
    </tr>
    <tr>
      <td>Dioxane</td>
      <td>13.9</td>
    </tr>
    <tr>
      <td>Dodecane</td>
      <td>13.7</td>
    </tr>
    <tr>
      <td>DMSO</td>
      <td>14.9</td>
    </tr>
    <tr>
      <td>Tetradecane</td>
      <td>15.6</td>
    </tr>
    <tr>
      <td>Pentanol</td>
      <td>24.1</td>
    </tr>
  </tbody>
</table>

<p>The take-home here is that diffusion measurements are specific to a solution temperature, and that good temperature control and/or monitoring (<a href="https://dx.doi.org/doi/10.1002/cphc.201900150" target="_blank" rel="noopener noreferrer">try a methanol capillary!</a>) are essential for quantitative diffusion measurements.</p>

<h1 id="diffusion-nmr">Diffusion NMR</h1>
<p>Pulsed-gradient diffusion NMR measurements involve:</p>
<ol>
  <li>Acquiring a sequence of 1D spectra with a range of gradient pulse strengths</li>
  <li>Extracting the intensities (integrals or peak heights) of peaks of interest</li>
  <li>Fitting the Stejsal-Tanner equation to these intensities as a function of gradient strength, and obtaining diffusion coefficients</li>
</ol>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <source media="(max-width: 480px)" srcset="/assets/resized/pgste-480x143.png"></source>
    
    <source media="(max-width: 800px)" srcset="/assets/resized/pgste-800x238.png"></source>
    
    <source media="(max-width: 1400px)" srcset="/assets/resized/pgste-1400x416.png"></source>
    
    <img class="img-fluid rounded z-depth-1" src="/assets/img/diffusionnmr/pgste.png">
</picture>

    </div>
</div>
<div class="caption">
    Basic pulsed gradient stimulated echo (PGSTE) diffusion NMR sequence.
</div>

<p>The Stejskal-Tanner equation relates the acquired signal intensity \(I\) to the gradient pulse amplitude \(g\), nuclear gyromagnetic ratio \(\gamma\), gradient pulse length \(\delta\) and measurement time \(\Delta\), and diffusion coefficient \(D\). The exact form of this equation varies for different pulse sequences and gradient pulse shapes, but a typical formulation (assuming perfectly square gradient pulses) is:</p>

\[I = I_0 e^{-D(g^2\delta^2\gamma^2(\Delta-\delta/3))}\]

<p>In theory we can run a diffusion experiment by varying any one of \(g\), \(\delta\), or \(\Delta\). In practice, \(\delta\) and \(\Delta\) are almost always held constant while the gradient pulse amplitude \(g\) is varied across a set range of typically 0–50 gauss/cm.</p>

<h2 id="convection">Convection</h2>

<p>Convection is probably the most persistent problem affecting diffusion NMR measurements. It results from small temperature gradients across the sample, can occur at any time, and should never be forgotten or ignored. Convection is more likely in some systems than others: an experiment run with a room temperature-equilibrated instrument on a small sample in viscous DMSO is unlikely to suffer from convection, while a punching in a 20° temperature increase on a CDCl3 sample and running a diffusion experiment the moment the target temperature is reached will almost guarantee convection. <a href="https://tscmacdonald.github.io/projects/enhanceddiffusion/">Time-resolved diffusion measurements</a> of dynamic reacting systems or systems under irradiation are also likely to suffer from convection.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <source media="(max-width: 480px)" srcset="/assets/resized/convection-480x148.png"></source>
    
    <source media="(max-width: 800px)" srcset="/assets/resized/convection-800x247.png"></source>
    
    <source media="(max-width: 1400px)" srcset="/assets/resized/convection-1400x433.png"></source>
    
    <img class="img-fluid rounded z-depth-1" src="/assets/img/diffusionnmr/convection.png">
</picture>

    </div>
</div>
<div class="caption">
    Convection ruins diffusion NMR measurements and can occur at any time. Left: convection is often visible as an unusual phase twist in some of the 1D gradient slice spectra. Right: convection occurs when a more dense section of fluid is higher than a less dense section of fluid. Assuming positive thermal expansion (warmer fluid is less dense than cooler fluid), this can happen either when a vertical temperature gradient results in cool fluid sitting above warm fluid (Rayleigh-Benard convection) or when a horizontal temperature gradient exists (Hadley convection). A layer of warm fluid above a layer of cool fluid does not result in a density inversion, and cannot drive convection.
</div>

<p>Here are some signs of convection to look for when running diffusion NMR experiments:</p>
<ul>
  <li>Convection will often cause phasing artefacts (see above), making it impossible to correctly phase all slices of the diffusion experiment at the same time. Always look at the spectral data before using it.</li>
  <li>Convection is somewhat random. Repeat the same measurement several times: if the results vary meaningfully, this may indicate convection.</li>
  <li>Convection will always result in an obtained diffusion coefficient higher than the real diffusion coefficient. If a range of diffusion coefficients are measured for the same sample, the lower values are likely to be more accurate than the higher values.</li>
  <li>The convection-induced error in a measurement increases roughly proportionally to \(\Delta\), the diffusion measureing time, while diffusion measurements are independent of \(\Delta\). Run a series of experiments with different \(\Delta\): if \(D\) increases with \(\Delta\), this is likely convection. The true diffusion coefficient can sometimes be found by fitting a line through multiple \(D(\Delta)\) measurements and extrapolating to \(\Delta = 0\).</li>
</ul>

<p>Here are some tips for avoiding or preventing convection:</p>
<ul>
  <li>Use a more viscous solvent. Experiments in DMSO-d6 are much less likely to suffer from convection than experiments in CDCl3; experiments at low temperature (=increased viscosity) are less likely to suffer from convection than experiments at high temperature (=decreased viscosity).</li>
  <li>Give the instrument plenty of time to equilibrate after temperature changes, and avoid changing the temperature unnecessarily.</li>
  <li>Use non-standard smaller NMR sample tubes: convection is less likely to occur in more narrow geometries. I’ve had success in replacing standard 5 mm NMR tubes with smaller 3 mm tunes. Similarly, don’t overfill your sample: 0.5 mL in a standard tube is plenty.</li>
  <li>Pack the sample with a physical obstruction to impede flow. <a href="https://pubs.acs.org/doi/10.1021/jacs.0c09072" target="_blank" rel="noopener noreferrer">I’ve had success</a> (see SI) by adding short pieces of broken glass TLC capillaries to a standard sample tube, and I’ve heard good things about glass wool. Avoid magnetic or high surface area materials - you want to disrupt flow without changing the chemical or magnetic environment. This approach can make shimming take a little longer, but I’ve found that lineshapes are normally OK eventually.</li>
</ul>

<p>For more on this topic, see this paper and many others from Gareth Morris’ research group: <a href="https://doi.org/10.1016/j.jmr.2014.12.006" target="_blank" rel="noopener noreferrer">Sample convection in liquid-state NMR: Why it is always with us, and what we can do about it</a>.</p>

<p>Final note: some diffusion NMR pulse sequences incorporate “convection suppression” elements, designed to filter out and remove the influence of convection. I don’t really understand how this works and am skeptical of relying on convection-suppressing sequences to filter out the effects of convection, rather than using the approaches above to physically prevent it.</p>

<h2 id="overlapping-peaks-give-averaged-diffusion-coefficients">Overlapping peaks give averaged diffusion coefficients</h2>

<p>Diffusion coefficients are obtained by fitting NMR peak intensities to the Stejskal-Tanner equation. “Intensity” here normally refers to either the peak integral or the peak amplitude: I prefer to use integrals due to the higher signal-to-noise and insensitivity to small changes in lineshape or shim during the experiment. But what happens when integrating a region of the spectrum captures overlapping peaks from multiple chemical species, or when looking at a peak corresponding to multiple chemical species in fast exchange? The data will give an <strong>averaged</strong> diffusion coefficient sitting somewhere between the diffusion coefficients of the overlapping species.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <picture>
    
    <source media="(max-width: 480px)" srcset="/assets/resized/peakoverlap-480x211.png"></source>
    
    <source media="(max-width: 800px)" srcset="/assets/resized/peakoverlap-800x352.png"></source>
    
    <source media="(max-width: 1400px)" srcset="/assets/resized/peakoverlap-1400x615.png"></source>
    
    <img class="img-fluid rounded z-depth-1" src="/assets/img/diffusionnmr/peakoverlap.png">
</picture>

    </div>
</div>
<div class="caption">
    Diffusion NMR measurements generally cannot resolve the diffusion coefficients of two overlapping peaks. Here, compounds A (red peaks) and B (blue peaks) respectively have diffusion coefficients of 1 and 3. These diffusion coefficients can be measured accurately by integrating non-overlapping peaks (red and blue lines) and fitting peak intensities to the Stejskal-Tanner equation. If the overlapping peak (green) is used  for monoexponential fitting, an intermediate _average_ diffusion value will be obtained.
</div>

<p>If the overlapping species have reasonably different diffusion coefficients, it’s sometimes possible to separately resolve their diffusion coefficients by fitting a multiexponential function to the obtained data—something like:</p>

\[I = I_1 e^{-D_1(g^2\delta^2\gamma^2(\Delta-\delta/3))}_1 + I_2 e^{-D_2(g^2\delta^2\gamma^2(\Delta-\delta/3))}\]

<p>Unfortunately, resolving overlapping peaks into separate diffusion coefficients like this tends to be difficult and uncertainties on the fitted parameters are often large. In most cases it’s probably better to throw away the overlapping peaks and limit your analysis to the well-resolved peaks of interest.</p>

  </article>

  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname  = 'tscmacdonald';
      var disqus_identifier = '/blog/2021/diffusiontips';
      var disqus_title      = "Don't be scared of diffusion NMR!";
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by Disqus.</a>
</noscript>
  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    <!--&copy; Copyright 2022 Thomas S. C. MacDonald. -->
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. <!-- Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank">Unsplash</a>. -->

    
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-216605799-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-216605799-1');
</script>






</html>
